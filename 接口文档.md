请查看并更新接口文档.md文件，包含本次开发的新接口：
1. 后端API：新增/修改的端点、参数和返回格式
2. 前端组件：新创建组件的props、events和使用方法
3. 数据模型：新增/修改的实体结构和关系
4. 地图交互：新增地图功能和数据格式

保持文档格式统一，使用markdown表格或代码块展示接口细节。

## 前端组件

### HomeView
```vue
主页面组件，显示欢迎信息和进入地图的链接
<template>
  <div class="home">
    <header class="home-header">
      <h1>武汉美食地图</h1>
      <p class="subtitle">探索武汉特色美食，发现城市美食文化</p>
    </header>
    
    <main class="home-content">
      <div class="intro-card">
        <h2>欢迎使用武汉美食地图系统</h2>
        <p>这里汇集了武汉各区域的特色餐厅和美食，点击下方按钮开始你的美食探索之旅。</p>
        <div class="actions">
          <router-link to="/map" class="map-btn">进入地图</router-link>
        </div>
      </div>
    </main>
  </div>
</template>
```

### MapView
```vue
地图页面组件，集成MapContainer和FilterPanel
<template>
  <div class="map-view">
    <header class="map-header">
      <h1>武汉美食地图</h1>
      <router-link to="/" class="home-link">返回首页</router-link>
    </header>
    
    <div class="map-content">
      <div class="filter-panel-container">
        <!-- 筛选面板将在下一步实现 -->
        <div class="filter-placeholder">
          <h3>筛选面板</h3>
          <p>将在下一步实现筛选和搜索功能</p>
        </div>
        
        <div v-if="restaurantStore.loading" class="loading-indicator">
          <span>加载中...</span>
        </div>
        <div v-else-if="restaurantStore.error" class="error-message">
          <span>{{ restaurantStore.error }}</span>
        </div>
        <div v-else class="restaurant-list">
          <h3>餐厅列表</h3>
          <div 
            v-for="restaurant in restaurantStore.filteredRestaurants" 
            :key="restaurant.id"
            class="restaurant-item"
            :class="{ 'active': selectedRestaurantId === restaurant.id }"
            @click="selectRestaurant(restaurant)"
          >
            <div class="restaurant-name">{{ restaurant.name }}</div>
            <div class="restaurant-meta">
              <span>{{ restaurant.food_type || '未分类' }}</span>
              <span>{{ restaurant.district || '未知区域' }}</span>
            </div>
          </div>
        </div>
      </div>
      
      <div class="map-wrapper">
        <MapContainer 
          :initial-center="[114.3008, 30.5433]" 
          :initial-zoom="12"
          @map-loaded="handleMapLoaded"
          @map-click="handleMapClick"
          @marker-click="handleMarkerClick"
          ref="mapContainerRef"
        />
      </div>
    </div>
  </div>
</template>
```

**属性与方法**
| 名称 | 类型 | 描述 |
|------|------|------|
| restaurantStore | ref | 餐厅状态管理实例 |
| mapContainerRef | ref | 地图容器组件引用 |
| mapInstance | ref | 地图实例引用 |
| selectedRestaurantId | ref | 当前选中的餐厅ID |
| handleMapLoaded | Function | 地图加载完成事件处理 |
| handleMapClick | Function | 地图点击事件处理 |
| handleMarkerClick | Function | 餐厅标记点击事件处理 |
| selectRestaurant | Function | 从列表选择餐厅的处理函数 |

**样式说明**
| 类名 | 描述 |
|------|------|
| .map-view | 弹性布局容器，占满视口高度，添加overflow: hidden防止溢出 |
| .map-header | 页面顶部标题栏，高度60px，背景色为#e63946 |
| .map-content | 弹性布局内容区域，计算高度为(100vh - 60px)，包含筛选面板和地图 |
| .filter-panel-container | 侧边筛选面板容器，固定宽度300px，白色背景 |
| .restaurant-list | 餐厅列表容器，可滚动，显示所有餐厅 |
| .restaurant-item | 单个餐厅项目，包含样式和悬停效果 |
| .map-wrapper | 弹性布局地图容器，占据剩余空间，相对定位 |

### MapContainer
```vue
地图容器组件，负责渲染和控制Mapbox地图
<template>
  <div class="map-container">
    <div id="map" ref="mapElement" class="map-element"></div>
    <div class="map-controls">
      <button @click="zoomIn" class="control-btn" title="放大">+</button>
      <button @click="zoomOut" class="control-btn" title="缩小">-</button>
      <button @click="resetView" class="control-btn" title="重置视图">⟳</button>
    </div>
    <div v-if="selectedRestaurant" class="restaurant-detail-panel">
      <RestaurantInfo 
        :restaurant="selectedRestaurant" 
        @close="closeRestaurantInfo" 
      />
    </div>
    <div v-if="loading" class="loading-overlay">
      <div class="loading-spinner"></div>
    </div>
  </div>
</template>
```

**属性与方法**
| 名称 | 类型 | 描述 |
|------|------|------|
| initialCenter | Array (prop) | 初始地图中心点坐标 [经度, 纬度]，默认为武汉市中心 |
| initialZoom | Number (prop) | 初始缩放级别，默认为12 |
| mapStyle | String (prop) | 地图样式URL，默认为mapbox街道样式 |
| restaurants | Array (prop) | 餐厅数据列表，默认为空数组 |
| mapInstance | ref | 地图实例引用 |
| markers | ref | 餐厅标记集合对象，键为餐厅ID |
| restaurantStore | Object | 餐厅状态管理对象 |
| selectedRestaurant | ref | 当前选中的餐厅 |
| loading | ref | 加载状态 |
| initMap() | Function | 初始化地图 |
| fetchRestaurants() | Function | 获取所有餐厅数据 |
| renderRestaurants() | Function | 在地图上渲染餐厅标记 |
| addMarker(restaurant) | Function | 添加单个餐厅标记 |
| clearMarkers() | Function | 清除所有餐厅标记 |
| handleMarkerClick(restaurant) | Function | 处理标记点击事件 |
| closeRestaurantInfo() | Function | 关闭餐厅详情 |
| getMapInstance() | Function | 获取地图实例方法，供父组件调用 |
| zoomIn() | Function | 放大地图 |
| zoomOut() | Function | 缩小地图 |
| resetView() | Function | 重置地图视图到初始状态 |

**事件**
| 名称 | 参数 | 描述 |
|------|------|------|
| map-loaded | mapInstance | 地图加载完成事件，返回地图实例 |
| map-click | e | 地图点击事件，返回点击位置信息 |
| map-move | {center, zoom} | 地图移动事件，返回中心点和缩放级别 |
| marker-click | restaurant | 标记点击事件，返回被点击的餐厅对象 |

**样式说明**
| 类名 | 描述 |
|------|------|
| .map-container | 相对定位容器，占满父元素的100%宽高，添加overflow: hidden防止溢出 |
| .map-element | 绝对定位元素，占满容器的100%宽高，确保地图正确渲染 |
| .map-controls | 位于地图右侧的控制按钮组，垂直排列，高于地图内容的z-index |
| .control-btn | 圆形控制按钮样式，包含鼠标悬停和点击效果 |
| .restaurant-detail-panel | 餐厅详情面板容器，绝对定位于地图左下角 |
| .restaurant-marker | 餐厅标记样式，圆形红色背景，添加鼠标悬停效果 |
| .loading-overlay | 加载状态覆盖层，半透明背景遮罩 |
| .loading-spinner | 加载旋转动画，显示加载状态 |

### RestaurantInfo
```vue
餐厅详情组件，显示餐厅详细信息
<template>
  <div class="restaurant-info">
    <div class="info-header">
      <h3>{{ restaurant.name }}</h3>
      <button class="close-btn" @click="$emit('close')">&times;</button>
    </div>
    
    <div v-if="restaurant.image_url" class="info-image">
      <img :src="restaurant.image_url" :alt="restaurant.name">
    </div>
    
    <div class="info-content">
      <div class="info-item">
        <div class="item-label">类型:</div>
        <div class="item-value">{{ restaurant.food_type || '未知' }}</div>
      </div>
      
      <div class="info-item">
        <div class="item-label">区域:</div>
        <div class="item-value">{{ restaurant.district || '未知' }}</div>
      </div>
      
      <div class="info-item">
        <div class="item-label">地址:</div>
        <div class="item-value">{{ restaurant.address }}</div>
      </div>
      
      <div v-if="restaurant.phone" class="info-item">
        <div class="item-label">电话:</div>
        <div class="item-value">{{ restaurant.phone }}</div>
      </div>
      
      <div v-if="restaurant.business_hours" class="info-item">
        <div class="item-label">营业时间:</div>
        <div class="item-value">{{ restaurant.business_hours }}</div>
      </div>
    </div>
    
    <div v-if="restaurant.description" class="info-description">
      <h4>餐厅介绍</h4>
      <p>{{ restaurant.description }}</p>
    </div>
    
    <div class="info-actions">
      <button class="action-btn" @click="navigateTo">
        <span>导航到这里</span>
      </button>
    </div>
  </div>
</template>
```

**属性与事件**
| 名称 | 类型 | 描述 |
|------|------|------|
| restaurant | Object (prop) | 餐厅详情对象，必须提供 |
| close | Event | 关闭详情面板事件 |
| navigateTo | Function | 导航到餐厅位置的方法(未实现完整功能) |

**样式说明**
| 类名 | 描述 |
|------|------|
| .restaurant-info | 餐厅详情容器，白色背景，圆角边框，最大高度80vh可滚动 |
| .info-header | 标题区域，深蓝色背景，显示餐厅名称和关闭按钮 |
| .info-image | 餐厅图片容器，固定高度180px |
| .info-content | 详情内容区域，包含餐厅基本信息 |
| .info-item | 信息项容器，弹性布局显示标签和值 |
| .info-description | 餐厅描述区域，边框分隔 |
| .info-actions | 操作按钮区域，底部边框分隔 |
| .action-btn | 操作按钮样式，红色背景白色文字 |

### RestaurantMarker
```vue
餐厅标记组件，用于显示餐厅在地图上的位置
<template>
  <div 
    class="marker-container" 
    :class="{ 'active': isActive }" 
    @click="handleClick"
  >
    <div class="marker-icon">
      <span>🍜</span>
    </div>
    <div v-if="showTooltip" class="marker-tooltip">
      {{ restaurant.name }}
    </div>
  </div>
</template>
```

**属性与事件**
| 名称 | 类型 | 描述 |
|------|------|------|
| restaurant | Object (prop) | 餐厅对象，必须提供 |
| isActive | Boolean (prop) | 是否处于选中状态，默认为false |
| showTooltip | ref | 是否显示提示信息，通过鼠标悬停控制 |
| handleClick | Function | 处理点击事件 |
| click | Event | 点击标记事件，返回餐厅对象 |
| handleMouseEnter | Function | 处理鼠标进入事件，显示提示 |
| handleMouseLeave | Function | 处理鼠标离开事件，隐藏提示 |

**样式说明**
| 类名 | 描述 |
|------|------|
| .marker-container | 标记容器，相对定位，添加鼠标悬停效果 |
| .marker-icon | 标记图标，红色圆形背景，文字居中 |
| .marker-tooltip | 悬停提示，绝对定位于标记上方，白色背景 |
| .active | 选中状态样式，更改标记颜色和缩放 |

## 后端API

### 健康检查API

```
GET /api/health
```

**响应**
```json
{
  "status": "success",
  "message": "API服务正常运行"
}
```

### 获取餐厅列表

```
GET /api/restaurants/
```

**查询参数**
- `district`: (可选) 按区域筛选
- `food_type`: (可选) 按美食类型筛选
- `query`: (可选) 按名称或描述搜索

**响应**
```json
[
  {
    "id": 1,
    "name": "黄鹤楼小吃店",
    "address": "武汉市武昌区蛇山西山坡特1号",
    "latitude": 30.5433,
    "longitude": 114.3008,
    "food_type": "湖北菜",
    "district": "武昌区",
    "image_url": "https://example.com/images/restaurant1.jpg"
  },
  {
    // 其他餐厅...
  }
]
```

### 获取餐厅详情

```
GET /api/restaurants/<id>
```

**路径参数**
- `id`: 餐厅ID

**响应**
```json
{
  "id": 1,
  "name": "黄鹤楼小吃店",
  "address": "武汉市武昌区蛇山西山坡特1号",
  "latitude": 30.5433,
  "longitude": 114.3008,
  "phone": "027-88888888",
  "food_type": "湖北菜",
  "description": "以热干面、豆皮等武汉特色小吃为主",
  "image_url": "https://example.com/images/restaurant1.jpg",
  "business_hours": "周一至周日 9:00-22:00",
  "district": "武昌区"
}
```

### 获取区域列表

```
GET /api/restaurants/districts
```

**响应**
```json
[
  "武昌区",
  "汉阳区",
  "江汉区",
  "洪山区"
]
```

### 获取美食类型列表

```
GET /api/restaurants/food-types
```

**响应**
```json
[
  "湖北菜",
  "川菜",
  "小吃",
  "烧烤",
  "西餐",
  "糕点"
]
```

### 获取附近餐厅

```
GET /api/restaurants/nearby
```

**查询参数**
- `lat`: (必须) 纬度
- `lng`: (必须) 经度
- `distance`: (可选) 半径范围，单位为公里，默认为2

**响应**
```json
[
  {
    "id": 1,
    "name": "黄鹤楼小吃店",
    "address": "武汉市武昌区蛇山西山坡特1号",
    "latitude": 30.5433,
    "longitude": 114.3008,
    "food_type": "湖北菜",
    "district": "武昌区",
    "distance_km": 0.25,
    "image_url": "https://example.com/images/restaurant1.jpg"
  },
  {
    // 其他附近餐厅...
  }
]
```

### 获取边界框内餐厅

```
GET /api/restaurants/bbox
```

**查询参数**
- `min_lat`: (必须) 最小纬度
- `min_lng`: (必须) 最小经度
- `max_lat`: (必须) 最大纬度
- `max_lng`: (必须) 最大经度

**响应**
```json
[
  {
    "id": 1,
    "name": "黄鹤楼小吃店",
    "address": "武汉市武昌区蛇山西山坡特1号",
    "latitude": 30.5433,
    "longitude": 114.3008,
    "food_type": "湖北菜",
    "district": "武昌区",
    "image_url": "https://example.com/images/restaurant1.jpg"
  },
  {
    // 区域内其他餐厅...
  }
]
```

### 按区域统计餐厅

```
GET /api/restaurants/stats/by-district
```

**响应**
```json
[
  {
    "district": "武昌区",
    "count": 3
  },
  {
    "district": "洪山区",
    "count": 1
  },
  {
    "district": "江汉区",
    "count": 1
  }
]
```

### 按美食类型统计餐厅

```
GET /api/restaurants/stats/by-food-type
```

**响应**
```json
[
  {
    "food_type": "湖北菜",
    "count": 1
  },
  {
    "food_type": "小吃",
    "count": 1
  },
  {
    "food_type": "烧烤",
    "count": 1
  },
  {
    "food_type": "西餐",
    "count": 1
  },
  {
    "food_type": "糕点",
    "count": 1
  }
]
```

### 获取餐厅评价

```
GET /api/restaurants/<id>/reviews
```

**路径参数**
- `id`: 餐厅ID

**响应**
```json
[
  {
    "id": 1,
    "restaurant_id": 1,
    "rating": 4,
    "comment": "味道很好，环境也不错。",
    "user_name": "武汉吃货",
    "created_at": "2023-04-20T14:30:00"
  },
  {
    // 其他评价...
  }
]
```

### 添加餐厅评价

```
POST /api/restaurants/<id>/reviews
```

**路径参数**
- `id`: 餐厅ID

**请求体**
```json
{
  "rating": 4,
  "comment": "味道很好，环境也不错。",
  "user_name": "武汉吃货"
}
```

**响应**
```json
{
  "id": 1,
  "restaurant_id": 1,
  "rating": 4,
  "comment": "味道很好，环境也不错。",
  "user_name": "武汉吃货",
  "created_at": "2023-04-20T14:30:00"
}
```

## 数据模型

### Restaurant 餐厅

| 字段 | 类型 | 必填 | 描述 |
|------|------|------|------|
| id | Integer | 是 | 主键 |
| name | String(100) | 是 | 餐厅名称 |
| address | String(200) | 是 | 地址 |
| latitude | Float | 是 | 纬度 |
| longitude | Float | 是 | 经度 |
| location | Geometry(Point,4326) | 自动 | 地理位置点 |
| phone | String(20) | 否 | 联系电话 |
| food_type | String(50) | 否 | 美食类型 |
| description | Text | 否 | 描述 |
| image_url | String(255) | 否 | 图片链接 |
| business_hours | String(200) | 否 | 营业时间 |
| district | String(50) | 否 | 所在区域 |
| created_at | DateTime | 自动 | 创建时间 |
| updated_at | DateTime | 自动 | 更新时间 |

### Review 评价

| 字段 | 类型 | 必填 | 描述 |
|------|------|------|------|
| id | Integer | 是 | 主键 |
| restaurant_id | Integer | 是 | 餐厅ID，外键 |
| rating | Integer | 是 | 评分(1-5星) |
| comment | Text | 否 | 评价内容 |
| user_name | String(50) | 否 | 用户名 |
| created_at | DateTime | 自动 | 创建时间 |

## 前端服务

### API服务

**文件路径**: `src/services/api.js`

| 函数名 | 参数 | 返回值 | 描述 |
|------|------|------|------|
| getRestaurants | filters: Object | Promise<Array> | 获取餐厅列表，可选筛选参数 |
| getRestaurantById | id: Number | Promise<Object> | 获取指定ID的餐厅详情 |
| getDistricts | 无 | Promise<Array> | 获取所有区域列表 |
| getFoodTypes | 无 | Promise<Array> | 获取所有美食类型列表 |
| getNearbyRestaurants | lat: Number, lng: Number, distance: Number | Promise<Array> | 获取指定坐标附近的餐厅 |
| getRestaurantsInBoundingBox | minLat: Number, minLng: Number, maxLat: Number, maxLng: Number | Promise<Array> | 获取指定矩形区域内的餐厅 |
| getRestaurantStatsByDistrict | 无 | Promise<Array> | 获取按区域统计的餐厅数量 |
| getRestaurantStatsByFoodType | 无 | Promise<Array> | 获取按美食类型统计的餐厅数量 |

### 状态管理

**文件路径**: `src/stores/restaurant.js`

**状态**
| 名称 | 类型 | 描述 |
|------|------|------|
| restaurants | Array | 所有餐厅数据 |
| filteredRestaurants | Array | 筛选后的餐厅数据 |
| selectedRestaurant | Object | 当前选中的餐厅 |
| loading | Boolean | 加载状态 |
| error | String | 错误信息 |
| filters | Object | 当前筛选条件 |
| districtList | Array | 区域列表 |
| foodTypeList | Array | 美食类型列表 |

**Actions**
| 名称 | 参数 | 描述 |
|------|------|------|
| fetchRestaurants | 无 | 获取所有餐厅数据 |
| fetchRestaurantDetails | id: Number | 获取指定ID的餐厅详情 |
| fetchDistrictList | 无 | 获取所有区域列表 |
| fetchFoodTypeList | 无 | 获取所有美食类型列表 |
| applyFilters | filterOptions: Object | 应用筛选条件 |
| resetFilters | 无 | 重置所有筛选条件 |
| setSelectedRestaurant | restaurant: Object | 设置选中的餐厅 |
| clearSelectedRestaurant | 无 | 清除选中的餐厅 |

## 空间数据格式

### GeoJSON

地理位置数据使用GeoJSON格式：

```json
{
  "type": "Point",
  "coordinates": [114.3008, 30.5433]
}
```

坐标系统使用WGS84 (EPSG:4326)，与Mapbox GL JS兼容。

## 后端辅助模块

### GeoHelper

**文件路径**: `app/geo_helper.py`

| 函数名 | 参数 | 返回值 | 描述 |
|------|------|------|------|
| point_from_coords | lng: Float, lat: Float, srid: Int | STPoint | 从经纬度创建点几何体 |
| calculate_distance | point1: STPoint, point2: STPoint | Float | 计算两点之间的距离(公里) |
| create_bbox | min_lng: Float, min_lat: Float, max_lng: Float, max_lat: Float, srid: Int | STPolygon | 创建边界框几何体 |
| within_distance | point1: STPoint, point2: STPoint, distance_km: Float | Boolean | 检查两点之间的距离是否在指定公里数内 |

## 地图交互功能

| 功能 | 描述 |
|------|------|
| 显示餐厅标记 | 在地图上以标记形式显示餐厅位置 |
| 点击标记查看详情 | 点击餐厅标记后，显示该餐厅的详细信息 |
| 地图缩放控制 | 通过按钮控制地图的放大和缩小 |
| 重置视图 | 恢复地图到初始视图状态 |
| 标记高亮 | 选中的餐厅标记会高亮显示 |
| 筛选餐厅 | 根据区域或美食类型筛选餐厅显示 |
| 搜索餐厅 | 根据餐厅名称或描述搜索 |
| 附近餐厅查询 | 查询用户当前位置附近的餐厅 |
| 区域内餐厅查询 | 查询地图可视区域内的餐厅 |
| 距离排序 | 根据与当前位置的距离排序餐厅 |
| 地理统计 | 展示各区域餐厅分布数量 |
| 地图事件监听 | 监听地图点击、移动等事件 |
| 全屏显示 | 支持地图全屏展示 |
| 比例尺 | 显示地图比例尺 |
| 餐厅列表联动 | 列表选择和地图标记联动 |